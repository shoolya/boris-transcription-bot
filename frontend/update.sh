#!/bin/bash

echo "๐ ะะพะปะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต BORIS Frontend..."

# ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฒัะต ะฟัะพัะตััั
echo "๐ ะััะฐะฝะฐะฒะปะธะฒะฐั ะฒัะต ะฟัะพัะตััั..."
pkill -f "npm run dev" || true
pkill -f "vite" || true
sleep 2

# ะัะธัะฐะตะผ ะบัั
echo "๐งน ะัะธัะฐั ะบัั..."
rm -rf node_modules/.vite
rm -rf .vite
rm -rf dist
sleep 1

# ะัะพะฒะตััะตะผ ัะฐะนะปั
echo "๐ ะัะพะฒะตััั ะบะปััะตะฒัะต ัะฐะนะปั..."
echo "App.tsx:"
head -5 src/App.tsx
echo ""

# ะะตัะตัะพะฑะธัะฐะตะผ
echo "๐จ ะะตัะตัะพะฑะธัะฐั ะฟัะพะตะบั..."
npm run build
sleep 2

# ะะฐะฟััะบะฐะตะผ ะฒ ัะพะฝะต
echo "๐ ะะฐะฟััะบะฐั Vite ะฒ ัะพะฝะต..."
nohup npm run dev > vite.log 2>&1 &
sleep 5

# ะัะพะฒะตััะตะผ ััะฐััั
echo "๐ ะกัะฐััั:"
ps aux | grep "npm run dev" | grep -v grep || echo "โ Vite ะฝะต ะทะฐะฟััะตะฝ"
echo ""

# ะัะพะฒะตััะตะผ ะฟะพัั
echo "๐ ะัะพะฒะตััั ะฟะพัั 3000:"
ss -tlnp | grep :3000 || echo "โ ะะพัั 3000 ะฝะต ะทะฐะฝัั"
echo ""

echo "โ ะะฑะฝะพะฒะปะตะฝะธะต ะทะฐะฒะตััะตะฝะพ!"
echo "๐ ะะพะณะธ: tail -f vite.log"
echo "๐ ะัะธะปะพะถะตะฝะธะต: http://89.169.183.205:3000"
